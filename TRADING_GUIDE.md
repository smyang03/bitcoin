# 비트코인 자동매매 시스템 - 매매 설정 가이드라인

**작성일:** 2025-11-14
**버전:** 1.0
**대상:** 모의거래 및 실거래 사용자

---

## 📋 목차

1. [시작하기 전에](#시작하기-전에)
2. [모의거래 모드 설정](#모의거래-모드-설정)
3. [실거래 모드 설정](#실거래-모드-설정)
4. [매매 설정 파라미터 상세 설명](#매매-설정-파라미터-상세-설명)
5. [추천 설정 시나리오](#추천-설정-시나리오)
6. [리스크 관리 설정](#리스크-관리-설정)
7. [자주 묻는 질문](#자주-묻는-질문)

---

## 🚀 시작하기 전에

### 필수 확인 사항

#### 1. 환경 준비
```bash
# Python 3.8 이상 필요
python3 --version

# 필수 패키지 설치
pip install pyupbit pandas numpy ta python-dotenv matplotlib requests
```

#### 2. API 키 설정 (실거래 시 필수)
```bash
# .env 파일 생성
cp .env.example .env

# .env 파일 편집
UPBIT_ACCESS_KEY=your_access_key_here
UPBIT_SECRET_KEY=your_secret_key_here
```

또는 `upbit/key.txt` 파일 사용:
```
Access key YOUR_ACCESS_KEY
Secret key YOUR_SECRET_KEY
```

#### 3. 업비트 API 키 권한 확인
- ✅ **자산 조회** 권한 필수
- ✅ **주문 조회** 권한 필수
- ✅ **주문하기** 권한 필수 (실거래 시)
- ⚠️ **출금하기** 권한은 **부여하지 마세요** (보안상 위험)

---

## 🧪 모의거래 모드 설정

### 1. 기본 설정 (user_config.json)

```json
{
  "initial_amount": 1000000.0,        // 초기 가상 자금
  "max_daily_profit": 0.05,           // 일일 최대 수익률 5%
  "max_daily_loss": 0.03,             // 일일 최대 손실률 3%
  "max_positions": 5,                 // 최대 동시 포지션
  "max_position_size": 0.3,           // 단일 포지션 최대 비중 30%
  "stop_loss_rate": 0.02,             // 손절매 비율 2%
  "paper_trading": true,              // 🧪 모의거래 모드 ON
  "daily_trade_limit": false,         // 일일 거래 제한 OFF
  "compound_interest": true,          // 복리 계산 ON
  "min_trade_amount": 50000.0,        // 최소 거래 금액 5만원
  "target_coins": [
    "KRW-BTC",
    "KRW-ETH",
    "KRW-XRP",
    "KRW-ADA",
    "KRW-SOL",
    "KRW-AVAX",
    "KRW-DOT",
    "KRW-MATIC"
  ]
}
```

### 2. 모의거래 모드 특징

✅ **장점:**
- 실제 돈을 사용하지 않음 (리스크 제로)
- 알고리즘 검증 가능
- 무제한 테스트 가능
- 거래 기록 DB에 저장됨

⚠️ **제한사항:**
- 실제 시장과 체결가 차이 있을 수 있음
- 슬리피지 미반영
- 시장 충격 미반영

### 3. 모의거래 실행

```bash
cd /home/user/bitcoin/upbit

# 설정 확인
python3 test_full_system.py

# 모의거래 시작
python3 main.py
```

**실행 화면:**
```
=== 업비트 자동매매 시스템 (Enhanced UI) ===
모드: 모의거래
초기자금: ₩1,000,000
대상코인: KRW-BTC, KRW-ETH, KRW-XRP, ...

🚀 Enhanced 웹 대시보드: http://localhost:5000
```

### 4. 모의거래 권장 기간

| 기간 | 목표 | 확인 사항 |
|------|------|-----------|
| **1-3일** | 시스템 안정성 확인 | 에러 없이 실행되는가? |
| **4-7일** | 알고리즘 검증 | 수익이 발생하는가? |
| **8-14일** | 성과 분석 | 평균 수익률은? 손실률은? |
| **15일+** | 실전 준비 | 실거래 전환 고려 |

---

## 💰 실거래 모드 설정

### ⚠️ 중요: 실거래 전 필수 체크리스트

- [ ] 모의거래 최소 7일 이상 테스트 완료
- [ ] 업비트 API 키 발급 및 권한 확인
- [ ] 업비트 계좌 잔고 확인 (설정 금액 이상)
- [ ] 손절매/일일 한도 설정 재확인
- [ ] 소액(10-50만원)으로 시작 계획
- [ ] 텔레그램 알림 설정 (권장)

### 1. 실거래 모드로 전환

`user_config.json` 수정:
```json
{
  "initial_amount": 100000.0,         // ⚠️ 소액으로 시작!
  "paper_trading": false,             // 💰 실거래 모드 ON
  ...
}
```

### 2. 실거래 모드 안전 설정

#### 보수적 설정 (초보자 권장)
```json
{
  "initial_amount": 100000.0,         // 10만원
  "max_daily_profit": 0.03,           // 일일 3% 목표
  "max_daily_loss": 0.02,             // 일일 2% 손실 제한
  "max_positions": 2,                 // 최대 2개 포지션
  "max_position_size": 0.3,           // 30% 이하
  "stop_loss_rate": 0.02,             // 2% 손절
  "min_trade_amount": 10000.0,        // 최소 1만원
  "target_coins": [
    "KRW-BTC",
    "KRW-ETH"
  ]
}
```

#### 중간 설정
```json
{
  "initial_amount": 500000.0,         // 50만원
  "max_daily_profit": 0.05,           // 일일 5% 목표
  "max_daily_loss": 0.03,             // 일일 3% 손실 제한
  "max_positions": 3,                 // 최대 3개 포지션
  "max_position_size": 0.25,          // 25% 이하
  "stop_loss_rate": 0.02,             // 2% 손절
  "min_trade_amount": 50000.0,        // 최소 5만원
  "target_coins": [
    "KRW-BTC",
    "KRW-ETH",
    "KRW-SOL",
    "KRW-AVAX"
  ]
}
```

#### 공격적 설정 (경험자)
```json
{
  "initial_amount": 1000000.0,        // 100만원
  "max_daily_profit": 0.07,           // 일일 7% 목표
  "max_daily_loss": 0.04,             // 일일 4% 손실 제한
  "max_positions": 5,                 // 최대 5개 포지션
  "max_position_size": 0.3,           // 30% 이하
  "stop_loss_rate": 0.025,            // 2.5% 손절
  "min_trade_amount": 50000.0,        // 최소 5만원
  "target_coins": [
    "KRW-BTC",
    "KRW-ETH",
    "KRW-XRP",
    "KRW-ADA",
    "KRW-SOL",
    "KRW-AVAX",
    "KRW-DOT",
    "KRW-MATIC"
  ]
}
```

### 3. 실거래 실행

```bash
cd /home/user/bitcoin/upbit

# 설정 확인
python3 test_full_system.py

# 실거래 시작
python3 main.py
```

**실행 화면:**
```
=== 업비트 자동매매 시스템 ===
모드: 실거래
초기자금: ₩100,000

🚨 실거래 모드입니다! 계속하시겠습니까? (yes/no): yes

자금 검증 - 실제 잔고: ₩150,000, 설정 금액: ₩100,000
✅ 자금 검증 통과

거래 시작!
```

### 4. 실거래 모니터링

#### 필수 모니터링 항목
1. **일일 손익 확인** (매일)
2. **포지션 현황** (수시)
3. **로그 파일 확인** (매일)
   - `trading_bot.log`
   - `trading_bot.db` (거래 기록)
4. **텔레그램 알림** (설정 시)

#### 위험 신호
- 🚨 연속 3일 손실
- 🚨 일일 손실 한도 반복 도달
- 🚨 손절매 빈번 발생
- 🚨 포지션 장기 보유 (7일+)

→ **이 경우 즉시 중단하고 설정 재검토**

---

## 📊 매매 설정 파라미터 상세 설명

### 1. initial_amount (초기 자금)

**설명:** 거래에 사용할 초기 자금
**타입:** float
**권장값:**
- 모의거래: 1,000,000 (₩100만)
- 실거래(초보): 100,000 (₩10만)
- 실거래(중급): 500,000 (₩50만)
- 실거래(고급): 1,000,000+ (₩100만+)

**주의사항:**
- ⚠️ 실거래 시 **실제 잔고보다 작아야 함**
- ⚠️ 잔고의 50% 이하 사용 권장
- ⚠️ 손실 가능한 금액만 사용

---

### 2. max_daily_profit (일일 최대 수익률)

**설명:** 이 수익률 달성 시 당일 거래 자동 중지
**타입:** float (0.0 ~ 1.0)
**권장값:**
- 보수적: 0.03 (3%)
- 중간: 0.05 (5%)
- 공격적: 0.07 (7%)

**예시:**
```
초기 자금: ₩1,000,000
max_daily_profit: 0.05 (5%)
→ ₩1,050,000 도달 시 당일 거래 중지
```

**팁:**
- 너무 높게 설정하면 목표 달성 어려움
- 너무 낮게 설정하면 수익 기회 놓침
- 시장 변동성 고려하여 설정

---

### 3. max_daily_loss (일일 최대 손실률)

**설명:** 이 손실률 도달 시 당일 거래 자동 중지
**타입:** float (0.0 ~ 1.0)
**권장값:**
- 보수적: 0.02 (2%)
- 중간: 0.03 (3%)
- 공격적: 0.04 (4%)

**예시:**
```
초기 자금: ₩1,000,000
max_daily_loss: 0.03 (3%)
→ ₩970,000 도달 시 당일 거래 중지
```

**중요:**
- 이 설정이 자산 보호의 핵심!
- 절대 5% 이상 설정하지 마세요
- 연속 손실 시 더 낮게 조정 고려

---

### 4. max_positions (최대 동시 포지션)

**설명:** 동시에 보유 가능한 최대 코인 종류 수
**타입:** int
**권장값:**
- 소액(10-50만): 2-3개
- 중액(50-100만): 3-5개
- 대액(100만+): 5-7개

**예시:**
```
max_positions: 5
현재 보유: BTC, ETH, XRP, ADA, SOL (5개)
→ 신규 매수 신호 발생해도 차단
```

**팁:**
- 적은 포지션 = 집중 투자, 높은 리스크
- 많은 포지션 = 분산 투자, 낮은 리스크
- 자금 규모에 비례하여 설정

---

### 5. max_position_size (단일 포지션 최대 비중)

**설명:** 전체 자금 대비 단일 코인의 최대 투자 비율
**타입:** float (0.0 ~ 1.0)
**권장값:**
- 보수적: 0.2 (20%)
- 중간: 0.3 (30%)
- 공격적: 0.4 (40%)

**예시:**
```
초기 자금: ₩1,000,000
max_position_size: 0.3 (30%)
→ BTC에 최대 ₩300,000까지 투자 가능
```

**경고:**
```
⚠️ max_positions × max_position_size > 1.0 이면 위험!

예: max_positions=5, max_position_size=0.3
→ 5 × 0.3 = 1.5 (150%)
→ 모든 포지션 최대로 열면 자금 부족!
```

**권장 조합:**
| max_positions | max_position_size | 합계 | 안전도 |
|---------------|-------------------|------|--------|
| 3 | 0.3 | 0.9 | ✅ 안전 |
| 5 | 0.2 | 1.0 | ✅ 안전 |
| 5 | 0.3 | 1.5 | ⚠️ 위험 |
| 10 | 0.2 | 2.0 | ❌ 위험 |

---

### 6. stop_loss_rate (손절매 비율)

**설명:** 평균 매수가 대비 하락 비율 도달 시 자동 매도
**타입:** float (0.0 ~ 1.0)
**권장값:**
- 보수적: 0.015 (1.5%)
- 중간: 0.02 (2%)
- 공격적: 0.03 (3%)

**예시:**
```
BTC 평균 매수가: ₩50,000,000
stop_loss_rate: 0.02 (2%)
손절가: ₩49,000,000

현재가가 ₩49,000,000 이하로 떨어지면 자동 매도
```

**팁:**
- 변동성 큰 코인 → 높게 설정 (3%)
- 변동성 작은 코인 → 낮게 설정 (1.5%)
- 너무 낮으면 빈번한 손절
- 너무 높으면 큰 손실

---

### 7. paper_trading (모의거래 모드)

**설명:** 모의거래 vs 실거래 모드 선택
**타입:** boolean
**값:**
- `true`: 🧪 모의거래 (가상 자금 사용)
- `false`: 💰 실거래 (실제 돈 사용)

**전환 시기:**
```
모의거래 → 실거래 전환 조건:
✅ 모의거래 최소 7일 테스트
✅ 평균 수익률 +2% 이상
✅ 손절매 정상 작동 확인
✅ 일일 한도 정상 작동 확인
✅ API 키 및 권한 확인
```

---

### 8. min_trade_amount (최소 거래 금액)

**설명:** 한 번의 거래에 사용하는 최소 금액
**타입:** float
**권장값:**
- 초기 자금 10만원: 10,000 (₩1만)
- 초기 자금 50만원: 50,000 (₩5만)
- 초기 자금 100만원: 50,000 (₩5만)

**주의:**
- 업비트 최소 주문 금액: ₩5,000
- 너무 낮으면 수수료 비중 높음
- 너무 높으면 거래 기회 감소

**수수료 영향:**
```
거래액 ₩10,000:
  수수료(왕복): ₩10 (0.1%)
  수익률 0.6% 이상 필요

거래액 ₩50,000:
  수수료(왕복): ₩50 (0.1%)
  수익률 0.6% 이상 필요
```

---

### 9. target_coins (대상 코인)

**설명:** 거래할 코인 목록
**타입:** list of strings
**권장:**

#### 안정성 우선 (초보자)
```json
"target_coins": [
  "KRW-BTC",   // 비트코인
  "KRW-ETH"    // 이더리움
]
```

#### 균형 (중급자)
```json
"target_coins": [
  "KRW-BTC",
  "KRW-ETH",
  "KRW-XRP",
  "KRW-SOL",
  "KRW-AVAX"
]
```

#### 다각화 (고급자)
```json
"target_coins": [
  "KRW-BTC",
  "KRW-ETH",
  "KRW-XRP",
  "KRW-ADA",
  "KRW-SOL",
  "KRW-AVAX",
  "KRW-DOT",
  "KRW-MATIC"
]
```

**선택 기준:**
- ✅ 거래량 많은 코인 (유동성)
- ✅ 변동성 적당한 코인 (리스크)
- ✅ 시가총액 상위 코인 (안정성)
- ❌ 신규 상장 코인 피하기
- ❌ 거래량 적은 코인 피하기

---

### 10. daily_trade_limit (일일 거래 제한)

**설명:** 하루에 같은 코인을 1회만 거래
**타입:** boolean
**권장값:**
- 단기 트레이딩: `false`
- 장기 투자: `true`

**예시:**
```
daily_trade_limit: true

오전 10시: BTC 매수
오전 11시: BTC 매도 (수익 실현)
오후 2시: BTC 매수 신호 → ❌ 차단 (당일 이미 거래함)
```

---

### 11. compound_interest (복리 계산)

**설명:** 수익을 재투자하여 복리 효과
**타입:** boolean
**권장값:** `true`

**효과:**
```
복리 OFF:
  초기: ₩1,000,000
  수익: ₩50,000
  → 다음 거래도 ₩1,000,000 기준

복리 ON:
  초기: ₩1,000,000
  수익: ₩50,000
  → 다음 거래는 ₩1,050,000 기준
```

---

## 🎯 추천 설정 시나리오

### 시나리오 1: 초보자 (안전 최우선)

**목표:** 시스템 학습 및 안정적 운영
**자금:** ₩100,000 ~ ₩300,000

```json
{
  "initial_amount": 200000.0,
  "max_daily_profit": 0.03,
  "max_daily_loss": 0.02,
  "max_positions": 2,
  "max_position_size": 0.3,
  "stop_loss_rate": 0.02,
  "paper_trading": true,
  "min_trade_amount": 50000.0,
  "target_coins": ["KRW-BTC", "KRW-ETH"]
}
```

**예상 결과:**
- 일일 수익 목표: ₩6,000 (3%)
- 일일 손실 한도: ₩4,000 (2%)
- 월 예상 수익: 10-15% (복리 시)

---

### 시나리오 2: 중급자 (균형)

**목표:** 안정적 수익 + 적당한 리스크
**자금:** ₩500,000 ~ ₩1,000,000

```json
{
  "initial_amount": 700000.0,
  "max_daily_profit": 0.05,
  "max_daily_loss": 0.03,
  "max_positions": 4,
  "max_position_size": 0.25,
  "stop_loss_rate": 0.02,
  "paper_trading": false,
  "min_trade_amount": 50000.0,
  "target_coins": [
    "KRW-BTC",
    "KRW-ETH",
    "KRW-SOL",
    "KRW-AVAX"
  ]
}
```

**예상 결과:**
- 일일 수익 목표: ₩35,000 (5%)
- 일일 손실 한도: ₩21,000 (3%)
- 월 예상 수익: 15-25% (복리 시)

---

### 시나리오 3: 고급자 (공격적)

**목표:** 고수익 추구 (고위험 감수)
**자금:** ₩1,000,000+

```json
{
  "initial_amount": 1500000.0,
  "max_daily_profit": 0.07,
  "max_daily_loss": 0.04,
  "max_positions": 6,
  "max_position_size": 0.2,
  "stop_loss_rate": 0.025,
  "paper_trading": false,
  "min_trade_amount": 50000.0,
  "target_coins": [
    "KRW-BTC",
    "KRW-ETH",
    "KRW-XRP",
    "KRW-ADA",
    "KRW-SOL",
    "KRW-AVAX"
  ]
}
```

**예상 결과:**
- 일일 수익 목표: ₩105,000 (7%)
- 일일 손실 한도: ₩60,000 (4%)
- 월 예상 수익: 25-40% (복리 시)

**⚠️ 경고:**
- 고위험 고수익 전략
- 반드시 모의거래 검증 후 사용
- 손실 가능 금액만 투자

---

## 🛡️ 리스크 관리 설정

### 1. 손절매 (Stop Loss) 전략

#### 자동 손절매
```
설정: stop_loss_rate = 0.02 (2%)

BTC 매수: ₩50,000,000
손절가: ₩49,000,000

현재가 ₩49,000,000 이하 → 자동 매도
```

#### 수동 긴급 매도
```python
# main.py 실행 중
# Ctrl+C 눌러서 메뉴 진입
# 'emergency_sell_all' 선택
```

---

### 2. 일일 한도 (Daily Limits)

#### 수익 한도
```
initial_amount: ₩1,000,000
max_daily_profit: 0.05 (5%)

현재 자산 ₩1,050,000 도달 → 당일 거래 중지
```

#### 손실 한도
```
initial_amount: ₩1,000,000
max_daily_loss: 0.03 (3%)

현재 자산 ₩970,000 도달 → 당일 거래 중지
```

---

### 3. 포지션 관리

#### 최대 포지션 수
```
max_positions: 3

현재 보유: BTC, ETH, XRP (3개)
SOL 매수 신호 → 차단
```

#### 포지션 크기 제한
```
initial_amount: ₩1,000,000
max_position_size: 0.3 (30%)

BTC 매수 가능 금액: 최대 ₩300,000
```

---

### 4. 추가 보호 장치

#### 자금 검증
```python
# 프로그램 시작 시 자동 검증
실제 잔고: ₩1,500,000
설정 금액: ₩2,000,000
→ ❌ 거래 시작 불가

실제 잔고: ₩1,500,000
설정 금액: ₩1,000,000
→ ✅ 거래 시작 가능
```

#### API 키 보안
```bash
# .gitignore에 자동 등록
.env
key.txt

# Git에 커밋되지 않음
```

---

## ❓ 자주 묻는 질문

### Q1. 모의거래는 얼마나 해야 하나요?

**A:** 최소 7일, 권장 14일 이상

**체크리스트:**
- [ ] 7일 이상 에러 없이 실행
- [ ] 평균 수익률 +2% 이상
- [ ] 손절매 정상 작동 확인
- [ ] 일일 한도 정상 작동 확인

---

### Q2. 실거래는 얼마로 시작해야 하나요?

**A:** ₩100,000 ~ ₩500,000 권장

**이유:**
- 너무 적으면 → 수수료 비중 높음
- 너무 많으면 → 초기 리스크 높음

**단계별 증액:**
```
1주차: ₩100,000 (테스트)
2주차: ₩300,000 (검증)
3주차: ₩500,000 (안정화)
4주차+: ₩1,000,000 (본격 운영)
```

---

### Q3. 목표 수익률은 얼마가 적당한가요?

**A:** 일일 3-5%, 월 15-25% 권장

**현실적 목표:**
| 기간 | 보수적 | 중간 | 공격적 |
|------|--------|------|--------|
| 일일 | 2-3% | 3-5% | 5-7% |
| 주간 | 5-10% | 10-15% | 15-25% |
| 월간 | 10-20% | 20-30% | 30-50% |

**주의:**
- 월 100% 이상은 비현실적
- 과도한 목표 → 과도한 리스크
- 복리 효과 고려

---

### Q4. 손실이 계속 나면 어떻게 하나요?

**A:** 즉시 중단 후 원인 분석

**체크 사항:**
1. 시장 상황 확인 (하락장?)
2. 설정 재검토 (너무 공격적?)
3. 로그 분석 (어떤 코인에서 손실?)
4. 전략 조정 필요

**대응 방안:**
- 거래 중단 (1-2주)
- 설정 보수적으로 변경
- 대상 코인 축소
- 모의거래로 재검증

---

### Q5. 코인은 몇 개 선택해야 하나요?

**A:** 자금 규모에 비례

| 초기 자금 | 권장 코인 수 | 예시 |
|-----------|--------------|------|
| ₩100,000 | 2개 | BTC, ETH |
| ₩300,000 | 3-4개 | BTC, ETH, SOL, AVAX |
| ₩500,000 | 4-5개 | 위 + XRP |
| ₩1,000,000 | 5-8개 | 위 + ADA, DOT, MATIC |

**원칙:**
- 적어도 2개 이상 (분산 투자)
- 많아도 10개 이하 (관리 한계)

---

### Q6. 24시간 켜두어야 하나요?

**A:** 아니요, 필요에 따라 조절 가능

**운영 방식:**
```
방식 1: 24시간 운영
  - 장점: 모든 기회 포착
  - 단점: 서버/전력 비용

방식 2: 거래 시간만 운영
  - 장점: 비용 절감
  - 단점: 일부 기회 놓침

권장: 09:00 ~ 23:00 운영
  - 주요 거래 시간 커버
  - 심야 변동성 회피
```

---

### Q7. 수익이 나면 출금해야 하나요?

**A:** 정기적 출금 권장

**출금 전략:**
```
방식 1: 전액 복리
  - 수익금 전액 재투자
  - 장점: 빠른 자산 증가
  - 단점: 손실 시 큰 타격

방식 2: 일부 출금 (권장)
  - 수익의 50% 출금
  - 장점: 리스크 관리
  - 단점: 성장 속도 감소

방식 3: 원금 회수
  - 원금 회수 후 수익으로만 운영
  - 장점: 심리적 안정
  - 단점: 운영 자금 감소
```

**예시:**
```
초기: ₩1,000,000
수익: ₩200,000 (20%)
→ ₩100,000 출금, ₩1,100,000로 재운영
```

---

### Q8. API 키가 해킹당하면 어떻게 되나요?

**A:** 출금 권한이 없으면 안전

**보안 조치:**
1. ✅ **출금 권한 절대 부여 금지**
2. ✅ IP 주소 제한 설정
3. ✅ 2FA(OTP) 활성화
4. ✅ API 키 주기적 재발급
5. ✅ .env 파일 Git 커밋 금지

**만약 해킹당하면:**
- 즉시 API 키 삭제
- 새 API 키 재발급
- 업비트 고객센터 연락

---

## 📞 지원 및 문의

### 문서
- `README.md` - 프로젝트 개요
- `CHANGELOG.md` - 변경 이력
- `VERIFICATION_REPORT.md` - 검증 리포트

### 테스트 스크립트
- `test_simulation.py` - 기본 로직 테스트
- `test_edge_cases.py` - 엣지 케이스 테스트
- `test_full_system.py` - 전체 시스템 테스트

### 로그 확인
```bash
# 거래 로그
tail -f trading_bot.log

# 데이터베이스
sqlite3 trading_bot.db "SELECT * FROM trades_v2 ORDER BY timestamp DESC LIMIT 10"
```

---

**작성:** Claude Code
**업데이트:** 2025-11-14
**버전:** 1.0

**⚠️ 면책 조항:**
이 프로그램은 교육 및 연구 목적으로 제공됩니다.
실제 투자 손실에 대해 개발자는 책임지지 않습니다.
투자는 본인의 판단과 책임하에 진행하세요.
